!function(){var e=angular.module("css-format",[]);e.factory("CSSComment",["CSSUtils",function(e){function t(e,t){this.raw=e||"",this.trimmed=this.raw.trim(),this.start=0,this.end=0,this.type=t||"selector"}return t.prototype.toString=function(){return this.trimmed},t}]),e.factory("CSSFormatter",["CSSLine","CSSComment","CSSParentSelector","CSSProperty","CSSSelectors","CSSUtils","cssNestedIndenter",function(e,t,n,r,i,a,o){function s(e,t){t=t||{},this._parser=e,this._options=angular.merge(this.defaultOptions(),t),this._lines=this.generateLines()}function u(){this.lines=[],this.current=new e,this.hasLines=function(){return this.lines.length||this.current.text().length}}return s.defaultOptions=function(){return{indent:4,selectors:{newLine:!0,linesBefore:0,linesBeforeComment:0,maxLength:90,forcePerLine:!1,combinatedPerLine:!0,linesBeforeMulti:0,multispace:1,nestedIndent:0},braces:{openNewLine:!1,openIndent:1,openIndentAfter:0,closeNewLine:!0,closeIndent:0,closeIndentAfter:0},property:{newLine:!0,spaceBetween:1,closeLast:!0,indentAfter:0},comments:{render:!0,renderProperty:!0,renderPropertyInline:!0,linesBefore:2,linesAfter:0,inlineSpace:1}}},s.prototype.defaultOptions=function(){return s.defaultOptions()},s.prototype.getLines=function(){return this._lines},s.prototype.generateLines=function(){var e=this._parser,r=e.getSelectors(),a=new u,s=this._options,l=0;s.selectors.nestedIndent&&o.indent(r,s.selectors.nestedIndent);for(var f,d,p,c=0;p=r[c];c++)p instanceof t?this.generateComment(p,l,a):p instanceof n?this.generateParentSelectors(p,f&&f instanceof t,l,a):p instanceof i&&(this.generateSelectors(p,f&&f instanceof t,p.indent,a),this.generateProperties(p,p.indent,a),d=p),f=p;return a.newLine(0),a.lines},s.prototype.generateComment=function(e,n,r){var i=this._options.comments;if(i.render){r.hasLines()&&(r.newLine(n),this.addEmptyLines(i.linesBefore,n,r));for(var u,a=e.toString().split("\n"),o=0,s=a.length-1;u=a[o];o++)r.current.push(new t(u)),o!==s&&r.newLine(n);this.addEmptyLines(i.linesAfter,n,r)}},s.prototype.generateParentSelectors=function(e,r,a,o){var u=(this._parser,this._options);u.selectors.newLine&&o.hasLines()&&o.newLine(a),this.generateLinesBeforeSelector(o,a,null,r),o.current.push(e),this.generateOpeningBrace(o,a);for(var c,f,l=0;f=e.children[l];l++)f instanceof t?this.generateComment(f,a+u.indent,o):f instanceof n?this.generateParentSelectors(f,c&&c instanceof t,a+u.indent,o):f instanceof i&&(this.generateSelectors(f,c&&c instanceof t,a+u.indent,o),this.generateProperties(f,a+u.indent,o)),c=f;this.generateClosingBrace(o,a)},s.prototype.generateSelectors=function(e,t,n,r){function u(t,n){var r=t===e.selectors.length-1;r||n.push(","+a.spaces(o.multispace))}for(var i=this._options,o=i.selectors,s=0;s<e.comments.length;s++)this.generateComment(e.comments[s],n,r);i.selectors.newLine&&r.hasLines()&&r.newLine(n),this.generateLinesBeforeSelector(r,n,e,t||e.comments.length);for(var f,l=0,c=e.selectors.length-1;f=e.selectors[l];l++){var d=[f];f.indent=n,u(l,d);var p=function(){if(!o.maxLength)return!1;if(o.forcePerLine)return l!==c;if(o.combinatedPerLine&&f.hasCombinator())return 0!==r.current.text().length&&0!==l&&r.newLine(n),l!==c;var e=r.current.length()+d.toString().length;return l!==c&&e>o.maxLength}();r.current.push(d),p&&r.newLine(n)}i.braces.openNewLine&&r.newLine(n),this.generateOpeningBrace(r)},s.prototype.generateProperties=function(e,n,i){for(var d,o=this._options,s=o.property,u=o.comments,l=e.properties,c=0,f=l.length-1;d=l[c];c++)d instanceof t?u.renderProperty&&(s.newLine&&i.newLine(n),i.current.push([a.spaceChar,d])):d instanceof r&&(s.newLine&&i.newLine(n+o.indent),i.current.push([d.name(),":"]),s.spaceBetween&&i.current.push(a.spaces(s.spaceBetween)),i.current.push(d.value()),(f!==c||s.closeLast&&f===c)&&i.current.push(";"),d.comment&&(u.inlineSpace&&i.current.push(a.spaces(u.inlineSpace)),i.current.push(d.comment)),s.indentAfter&&i.current.push(a.spaces(s.indentAfter)));this.generateClosingBrace(i,n)},s.prototype.generateOpeningBrace=function(e,t){var n=e.current,r=this._options.braces;r.openNewLine&&e.newLine(t),r.openIndent&&n.push(a.spaces(r.openIndent)),n.push("{"),r.openIndentAfter&&n.push(a.spaces(r.openIndentAfter))},s.prototype.generateClosingBrace=function(e,t){var n=e.current,r=this._options.braces;r.closeNewLine&&e.newLine(t),r.closeIndent&&n.push(a.spaces(r.closeIndent)),e.current.push("}"),r.closeIndentAfter&&n.push(a.spaces(r.closeIndentAfter))},s.prototype.generateLinesBeforeSelector=function(e,t,n,r){var i=this._options.selectors,a=function(){if(!e.hasLines())return 0;var t=i.linesBefore;return r?t=i.linesBeforeComment:i.linesBeforeMulti&&(!n||n.selectors.length>1)&&(t=Math.max(t,i.linesBeforeMulti)),t}();this.addEmptyLines(a,t,e)},s.prototype.addEmptyLines=function(e,t,n){for(var r=0;e>r;r++)n.newLine(t);return e},s.prototype.toString=function(){for(var n,e="",t=0;n=this._lines[t];t++)e+=String.spaces(n.indent)+n+"\n";return e},u.prototype.newLine=function(t){this.lines.push(this.current),this.current=new e,this.current.indent=t||0},s}]),e.factory("CSSLine",[function(){function e(e,n){this._text=new t(n),this.indent=e||0}function t(e){this.push(e)}return e.prototype.text=function(e){return"undefined"!=typeof e&&(this._text=new t(e)),this._text},e.prototype.push=function(e){this._text.push(e)},e.prototype.length=function(){return this._text.toString().length},e.prototype.toString=function(){return this._text.toString()},t.prototype=new Array,t.prototype._push=t.prototype.push,t.prototype.push=function(e){function n(e,t){if(e instanceof Array)for(var r=0;r<e.length;r++)n(e[r]);else"undefined"!=typeof e&&t._push(e)}if(e instanceof Array)for(var t=0;t<e.length;t++)n(e[t],this);else"undefined"!=typeof e&&this._push(e)},t.prototype.toString=function(){for(var e="",t=0;t<this.length;t++)e+=this[t].toString();return e},e}]),e.factory("CSSParentSelector",[function(){function e(e){this.selector=e,this.children=[],this.start=0,this.end=0}return e.prototype.toString=function(){return this.selector},e}]),e.factory("CSSParser",["CSSComment","CSSParentSelector","CSSProperty","CSSSelectors","CSSSelector",function(e,t,n,r,i){function a(e){this.css=e,this.i=0,this.parentSelectors=["@media"]}function o(e){function f(){s&&(r.push(s),c.length&&(s.comments=c,c=[])),s=null,i="none"}function d(){u&&s&&(s.properties.push(u),l=u,u=null)}var n="string"==typeof e?new a(e):e,r=this._selectors=[],i="none",s=null,u=null,l=null,c=[];if(n.css)for(var p;n.i<n.css.length;n.i++){var h=this.skipWhiteSpace(n);if(p=n.css[n.i],"/"===p){if("*"!==n.css[n.i+1])throw'Illegal character "/"';"none"==i?c.push(this.parseComment(n,"selector")):h&&s?s.properties.push(this.parseComment(n,"property")):!h&&l&&(l.comment=this.parseComment(n,"property-inline"))}else if("none"===i)if(this.matchAhead(n.parentSelectors,n)){var v=this.parseTill("{",n);n.i++;for(var y,g=new t(v.trim()),m=new o(n),b=0;y=m.getSelectors()[b];b++)g.children.push(y);r.push(g)}else{if("}"===p)break;if(s=this.parseSelectors(n),!s){f();continue}i="parse-property"}else if("parse-property"===i){if(u=this.parseProperty(n),u.isEnd){f();continue}i="parse-value"}else if("parse-value"===i){var v=this.parseValue(n,u);d(),v.isEnd?f():i="parse-property"}}}return o.prototype.getSelectors=function(){return this._selectors},o.prototype.skipWhiteSpace=function(e){for(var n,t=!1;(n=e.css[e.i])&&-1!==" 	\n\r".indexOf(n);e.i++)t||-1!==" 	".indexOf(n)||(t=!0);return t},o.prototype.parseTill=function(e,t){for(var r,n="";(r=t.css[t.i])&&r!==e;t.i++)n+=r;return n},o.prototype.matchAhead=function(e,t){for(var i,n=0,r=!0;i=t.parentSelectors[n];n++){for(var o,a=t.i;o=t.css[a];a++){var s=a-t.i;if(s===i.length)break;if(o!==i[s]){r=!1;break}}if(r)return i}return null},o.prototype.parseComment=function(t,n){for(var a,r="",i=t.i;(a=t.css[t.i])&&("\r"===a||(r+=a,"/"!==a||"*"!==t.css[t.i-1]));t.i++);var o=new e(r,n);return o.start=i,o.end=t.i,o},o.prototype.parseSelectors=function(e){var t="",n=[],a=new r(n);a.start=e.i;for(var o;o=e.css[e.i];e.i++){if("{"===o)return t=t.trim(),t&&n.push(new i(t)),a.end=e.i,a;if(","!==o){if("}"===o)break;t+=o}else t=t.trim(),n.push(new i(t)),t=""}if(t.trim())throw'End of document reached prematurely while parsing selectors: "'+n+'" ending with "'+t+'"';return null},o.prototype.parseProperty=function(e){var t=new n,r="";t.start=e.i;for(var i;i=e.css[e.i];e.i++){if(":"===i)return t.name(r),t;if("}"===i){if(r.trim())throw"Premature end while parsing property: "+r;return t.name(r),t.isEnd=!0,t.end=e.i,t}r+=i}throw"End of document reached prematurely while parsing property: "+r},o.prototype.parseValue=function(e,t){for(var o,n="",r=null,i="value";o=e.css[e.i];e.i++){if("'"===o||'"'===o)"literal"===i&&r===o?i="value":"value"===i&&(i="literal",r=o);else if((";"===o||"}"===o)&&"value"===i)break;n+=o}return t.value(n),t.isEnd="}"===o,t.end=e.i,t},o}]),e.factory("CSSProperty",["CSSPropertyName","CSSPropertyValue","CSSUtils",function(e,t,n){function r(n,r){this._name="string"==typeof n?new e(n):null,this._value="string"==typeof r?new t(r):null,this.comment=null,this.start=0,this.end=0}return r.prototype.name=function(t){return"undefined"==typeof t?this._name:this._name=new e(t)},r.prototype.value=function(e){return"undefined"==typeof e?this._value:this._value=new t(e)},r.prototype.toString=function(e,t){var r=n.indent(this.name()+": "+this.value()+";",e,t);return this.comment&&(r+=" "+this.comment),r},r}]),e.factory("CSSPropertyName",[function(){function e(e){this.name=e.trim()}return e.prototype.toString=function(){return this.name},e}]),e.factory("CSSPropertyValue",[function(){function e(e){this.value=e.trim()}return e.prototype.toString=function(){return this.value},e}]),e.factory("CSSSelector",[function(){function e(e){this.name=e.trim()}return e.prototype.hasCombinator=function(){return-1!==this.name.indexOf(" ")||-1!==this.name.indexOf(">")||-1!==this.name.indexOf("+")||-1!==this.name.indexOf("~")},e.prototype.toString=function(){return this.name},e}]),e.factory("CSSSelectors",["CSSUtils",function(e){function t(e,t){this.selectors=e||[],this.properties=t||[],this.start=0,this.end=0,this.indent=0,this.comments=[]}return t.prototype.compareSpecificity=function(e){return this.selectors[0].compareSpecificity(e.selectors[0])},t.prototype.toString=function(){return this.selectors.toString()},Object.defineProperty(t.prototype,"rootSelector",{get:function(){return this.selectors[0].rootSelector},enumerable:!0}),t}]),e.factory("CSSTableOfContents",["CSSComment","CSSFormatter","CSSLine","CSSUtils",function(e,t,n,r){function i(n,i){this._options=i=i||{};var a=new t(n,i),o=a.getLines(),s=this._output=this.generateTableLines(o);if(i.showLineNumbers)for(var l,u=0;l=s[u];u++)if(l.comment){var c=this.getCommentLineIndex(l.comment,o);if(c>=0){var f=l.text().toString().substr(1+2*r.spaceChar.length),d=r.minLeft((c+s.length+1).toString(),5);l.text(new e("*"+d+f))}}for(var h,u=0,p=0;h=o[u];u++){if(i.tocIndent){for(var g,f=h.text(),v=0;g=f[v];v++)if("number"==typeof g.tableIndent){p=g.tableIndent;break}h.indent+=p}s.push(h)}}return i.prototype.getLines=function(){return this._output},i.prototype.getCommentLineIndex=function(e,t){for(var r,n=0;r=t[n];n++)for(var a,i=0;a=r.text()[i];i++)if(a===e)return n;return-1},i.prototype.generateTableLines=function(t){for(var l,i=[],a=[],o={},s=this._options,u=0;l=t[u];u++){var c=l.text(),f=c.toString();if(c[0]instanceof e&&0===f.indexOf("/*")){var d=this.getDepthString(c[0]);if(1===d.length)continue;i.push(c[0]),o[d]=0}}for(var p in o)a.push(p);for(a.sort(),a.reverse(),u=0,d;d=a[u];u++)o[d]=u+1;var t=[],h="number"==typeof s.depthIndent?s.depthIndent:4;t.push(new n(0,new e("/*"))),t.push(new n(1,new e("* TABLE OF CONTENTS"))),t.push(new n(1,new e("*")));for(var v,u=0;v=i[u];u++){var d=this.getDepthString(v),g=o[d],m=this.extractComment(v);if(m){var l=new n(1,new e("*"+r.indent("- "+m,g)));l.comment=v,v.tableIndent=l.tableIndent=(g-1)*h,t.push(l)}}return t.push(new n(1,new e("*"))),t.push(new n(1,new e("*/"))),t.push(new n(0)),t.push(new n(0)),t.depthSet=o,t},i.prototype.getDepthString=function(e){for(var t="",n=1;n<e.trimmed.length;n++){var r=e.trimmed[n];if("*"!==r)break;t+="*"}return t},i.prototype.extractComment=function(e){for(var n,o,t=e.trimmed.substr(1,e.trimmed.length-2),r="",i=!1,a=0;o=t[a];a++){if("	"===o)o="    ",i=!0;else{if("\r"===o||"\n"===o)break;if("*"===o&&!i)continue}i=!0,r+=o}for(var o,a=r.length-1;o=r[a];a--)if("*"!==o){n=r.substr(0,a);break}return n.trim()},i.prototype.toString=function(){for(var n,e="",t=0;n=this._output[t];t++)e+=r.spaces(n.indent)+n.text+"\n";return e},i}]),e.factory("CSSUtils",[function(){var e;return e={spaceChar:"&nbsp;",indentString:"&nbsp;&nbsp;&nbsp;&nbsp;",indent:function(t,n,r){n="number"==typeof n?n:1,r="undefined"==typeof r?e.indentString:r;for(var i="",a=0;n>a;a++)i+=r;return i+t},spaces:function(t,n){for(var r="",i=0;t>i;i++)r+=n||e.spaceChar;return r},padLeft:function(t,n,r){r=r||e.spaceChar;for(var i=0;n>i;i++)t=r+t;return t},minLeft:function(t,n,r){r=r||e.spaceChar;for(var i=t.length,a=0;n>i+a;)t=r+t,a++;return t}}}]),function(){function t(e,t,n,r,i,a){function s(e,t){e.$watch("lines",function(){if(t.html(""),e.lines)for(var r,n=0;r=e.lines[n];n++){var i=o('<div class="css-line"></div>');if(t.append(i),0!==r.text().length){r.indent&&i.append('<span class="indent">'+a.spaces(r.indent)+"</span>");for(var l,s=0;l=r.text()[s];s++){var c=u(l);c?i.append('<span class="'+c+'">'+l+"</span>"):i.append("<span>"+l+"</span>")}}else i.append("<span>&nbsp;</span>")}})}function u(a){return a instanceof e?"css-comment "+a.type:a instanceof t?"css-selector":a instanceof n?"css-selector":a instanceof r?"css-property-name":a instanceof i?"css-property-value":"css-text"}var o=angular.element;return{restrict:"A",scope:{lines:"=cssLines"},link:s}}e.directive("cssLines",t),t.$inject=["CSSComment","CSSParentSelector","CSSSelector","CSSPropertyName","CSSPropertyValue","CSSUtils"]}(),e.service("cssNestedIndenter",["CSSSelectors",function(e){function t(e){function r(){":"!==n&&(n&&t.push(n),n="")}for(var t=[],n="",i=0;i<e.length;i++){var a=e[i];switch(a){case".":case"[":case":":r();break;case" ":case">":case"~":case"+":if("\\"===e[i-1]){n=n.substr(n.length-1);break}r();continue}n+=a}return r(),t}this.indent=function(n,r){for(var o,i={},a=0;o=n[a];a++)if(o instanceof e){for(var s=o.selectors[0],u=t(s.name),l=void 0,c=u.slice(0);"undefined"==typeof l&&c.length;)c.pop(),l=i[c.join()];l=(l||0)+1;var f=u.join();i[f]=l,o.indent=(l-1)*(r||4)}}}])}();